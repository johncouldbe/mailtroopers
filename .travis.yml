language: node_js
node_js:
- 6.11.3
services:
- mongodb
cache:
  directories:
  - server/node_modules
  - client/node_modules
before_script: cd client
script:
- npm i && npm test
env:
- CI=true
before_deploy: cd ../server
deploy:
  provider: heroku
  skip_cleanup: true
  api_key:
    secure: RhZbZGQHIfkH/FSx98If4N+itLlJkw5Hnt1751pMZT7RgkbJSVVg2dDI+c3p4HoUUF7+1Sg/MVcd0O2fT54+vL3XBmWAx7VlXerr1sZifUKL1W12ZluTURt2hbUwqDxvSQTEXNoOHXrAVcHovuX+gsyQvFT2qZOPmYc5dQCdi2kJr+tMYz4Rl9W+O6qQ+ZPcze6RYIUopjs9gwHtyv3TdUAU5FemToHgNizS7XikC0MbezixToVAoJyUcJ6kBsSBDRiGfDHAA+TdmiEFwl7b1pNCXu/4Ybh6IUFAwqgLGRm20v7uDvLM7pls4pUcGLEt67b5V3n8nv3jDm1oWCpHNZt1F3xnbKnB/IZBTf3UDLqE4mjz1leiEcxhZepxSYG6HbFmCOZ60TsIjq1anTrfWAGFQv7pYld+CW7FsE6LwfRtrBs27etH5+kTu1zIVQJz6uRVBPqdgYWwBkEJ/iHq/kEFnFo7haIm0qBnV1dgyDcf3/E/i5Gy53ZHatQou/loQF87AkTvQa3CKyBDy3G2Emr50/Z7DL4FgjljnBHYWiJ9JYjXHMialGRs3dU6iuwhJJUQyEJHR19zvkj/ycGm6JiNTBVVXaEwDlpuCt6nBw27ZKIzTvWb8XAYQdgKaHwjUbkn8nbwUrIR3/EaYTjydnGI0aMMKagxy99D+wxo2u0=
  on:
    repo: johncouldbe/mailtroopers
