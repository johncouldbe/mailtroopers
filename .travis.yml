language: node_js
node_js:
- 6.11.3
services:
- mongodb
cache:
  directories:
  - server/node_modules
  - client/node_modules
before_script: cd client
script:
- npm i && npm test
env:
- CI=true
before_deploy: cd ../server
deploy:
  provider: heroku
  skip_cleanup: true
  api_key:
    secure:
      SwVrlaDrok1PB85IHBMIzmawzzZ5nuXkt8Xc5jL7Q9TBiGMEuxfKeyM3NPpamnTdGBECEgnLyPRLTFISmJ0ibvbtKmC2ATEH/Y83VBx0e1aPit8oSWrh/CTKZYFp7mPwG5v/iXDvH7VEX/lNO1tNv+d4c7r2UbCDe70YHXmK7bkDLBI99oQ5TQTIDDFNkzZ7y4rPlyFL7Pg/o9n90r43lVSgBZAj/XXuZOYMJH1PVS77bat4HrmenvcKewEH5/GDbllOKCH77+cZm47IN7ToFKvW9kxdonT1wEHFzrNszXrtSVkkhXJ1coH8vJN00KEHpBVFZCQFakLZnDlVmGNFD72O1rvt3Ya7D5nLB05VwwqoZgxSOddeSXnxaTAdQPFTkuUmPKpvQqeXvfuTY+Yw1Rbae8NUJtQej86/A8IQMVdM3dFZBAqkms93JjKp9dgKeAu09yK6UJ5PZIHNuXxV9Mf1moV1fxUMHxz0FmFd/x3yErDyS4NqLkLAx1+WTc62FYDNQBff2SZTA96otidiId0j5TSQj72tfqVLmQ809GCxvFDIrm2YetlAil+WyZSk5CEjXQY+E1HDRqsAbXxiOCcRTR6r/nyfXzUg//3RhljXiwAGm99218KsJWATKFAyc6GibT7xR2Hlt42uPeMVB4v3orjg6lPJwaXtLkdV8Yg=
      app: mailtroopers
    on:
      repo: johncouldbe/mailtroopers
